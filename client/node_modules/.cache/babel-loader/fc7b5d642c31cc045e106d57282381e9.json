{"ast":null,"code":"\"use strict\";\n\nlet util = require(\"util\");\n\nlet Stream = require(\"stream\");\n\nlet Parser = require(\"./parser-async\");\n\nlet Packer = require(\"./packer-async\");\n\nlet PNGSync = require(\"./png-sync\");\n\nlet PNG = exports.PNG = function (options) {\n  Stream.call(this);\n  options = options || {}; // eslint-disable-line no-param-reassign\n  // coerce pixel dimensions to integers (also coerces undefined -> 0):\n\n  this.width = options.width | 0;\n  this.height = options.height | 0;\n  this.data = this.width > 0 && this.height > 0 ? Buffer.alloc(4 * this.width * this.height) : null;\n\n  if (options.fill && this.data) {\n    this.data.fill(0);\n  }\n\n  this.gamma = 0;\n  this.readable = this.writable = true;\n  this._parser = new Parser(options);\n\n  this._parser.on(\"error\", this.emit.bind(this, \"error\"));\n\n  this._parser.on(\"close\", this._handleClose.bind(this));\n\n  this._parser.on(\"metadata\", this._metadata.bind(this));\n\n  this._parser.on(\"gamma\", this._gamma.bind(this));\n\n  this._parser.on(\"parsed\", function (data) {\n    this.data = data;\n    this.emit(\"parsed\", data);\n  }.bind(this));\n\n  this._packer = new Packer(options);\n\n  this._packer.on(\"data\", this.emit.bind(this, \"data\"));\n\n  this._packer.on(\"end\", this.emit.bind(this, \"end\"));\n\n  this._parser.on(\"close\", this._handleClose.bind(this));\n\n  this._packer.on(\"error\", this.emit.bind(this, \"error\"));\n};\n\nutil.inherits(PNG, Stream);\nPNG.sync = PNGSync;\n\nPNG.prototype.pack = function () {\n  if (!this.data || !this.data.length) {\n    this.emit(\"error\", \"No data provided\");\n    return this;\n  }\n\n  process.nextTick(function () {\n    this._packer.pack(this.data, this.width, this.height, this.gamma);\n  }.bind(this));\n  return this;\n};\n\nPNG.prototype.parse = function (data, callback) {\n  if (callback) {\n    let onParsed, onError;\n\n    onParsed = function (parsedData) {\n      this.removeListener(\"error\", onError);\n      this.data = parsedData;\n      callback(null, this);\n    }.bind(this);\n\n    onError = function (err) {\n      this.removeListener(\"parsed\", onParsed);\n      callback(err, null);\n    }.bind(this);\n\n    this.once(\"parsed\", onParsed);\n    this.once(\"error\", onError);\n  }\n\n  this.end(data);\n  return this;\n};\n\nPNG.prototype.write = function (data) {\n  this._parser.write(data);\n\n  return true;\n};\n\nPNG.prototype.end = function (data) {\n  this._parser.end(data);\n};\n\nPNG.prototype._metadata = function (metadata) {\n  this.width = metadata.width;\n  this.height = metadata.height;\n  this.emit(\"metadata\", metadata);\n};\n\nPNG.prototype._gamma = function (gamma) {\n  this.gamma = gamma;\n};\n\nPNG.prototype._handleClose = function () {\n  if (!this._parser.writable && !this._packer.readable) {\n    this.emit(\"close\");\n  }\n};\n\nPNG.bitblt = function (src, dst, srcX, srcY, width, height, deltaX, deltaY) {\n  // eslint-disable-line max-params\n  // coerce pixel dimensions to integers (also coerces undefined -> 0):\n\n  /* eslint-disable no-param-reassign */\n  srcX |= 0;\n  srcY |= 0;\n  width |= 0;\n  height |= 0;\n  deltaX |= 0;\n  deltaY |= 0;\n  /* eslint-enable no-param-reassign */\n\n  if (srcX > src.width || srcY > src.height || srcX + width > src.width || srcY + height > src.height) {\n    throw new Error(\"bitblt reading outside image\");\n  }\n\n  if (deltaX > dst.width || deltaY > dst.height || deltaX + width > dst.width || deltaY + height > dst.height) {\n    throw new Error(\"bitblt writing outside image\");\n  }\n\n  for (let y = 0; y < height; y++) {\n    src.data.copy(dst.data, (deltaY + y) * dst.width + deltaX << 2, (srcY + y) * src.width + srcX << 2, (srcY + y) * src.width + srcX + width << 2);\n  }\n};\n\nPNG.prototype.bitblt = function (dst, srcX, srcY, width, height, deltaX, deltaY) {\n  // eslint-disable-line max-params\n  PNG.bitblt(this, dst, srcX, srcY, width, height, deltaX, deltaY);\n  return this;\n};\n\nPNG.adjustGamma = function (src) {\n  if (src.gamma) {\n    for (let y = 0; y < src.height; y++) {\n      for (let x = 0; x < src.width; x++) {\n        let idx = src.width * y + x << 2;\n\n        for (let i = 0; i < 3; i++) {\n          let sample = src.data[idx + i] / 255;\n          sample = Math.pow(sample, 1 / 2.2 / src.gamma);\n          src.data[idx + i] = Math.round(sample * 255);\n        }\n      }\n    }\n\n    src.gamma = 0;\n  }\n};\n\nPNG.prototype.adjustGamma = function () {\n  PNG.adjustGamma(this);\n};","map":{"version":3,"sources":["/Users/marcusnorwood/Sites/music-site/dale-street-studio-music/client/node_modules/pngjs/lib/png.js"],"names":["util","require","Stream","Parser","Packer","PNGSync","PNG","exports","options","call","width","height","data","Buffer","alloc","fill","gamma","readable","writable","_parser","on","emit","bind","_handleClose","_metadata","_gamma","_packer","inherits","sync","prototype","pack","length","process","nextTick","parse","callback","onParsed","onError","parsedData","removeListener","err","once","end","write","metadata","bitblt","src","dst","srcX","srcY","deltaX","deltaY","Error","y","copy","adjustGamma","x","idx","i","sample","Math","pow","round"],"mappings":"AAAA;;AAEA,IAAIA,IAAI,GAAGC,OAAO,CAAC,MAAD,CAAlB;;AACA,IAAIC,MAAM,GAAGD,OAAO,CAAC,QAAD,CAApB;;AACA,IAAIE,MAAM,GAAGF,OAAO,CAAC,gBAAD,CAApB;;AACA,IAAIG,MAAM,GAAGH,OAAO,CAAC,gBAAD,CAApB;;AACA,IAAII,OAAO,GAAGJ,OAAO,CAAC,YAAD,CAArB;;AAEA,IAAIK,GAAG,GAAIC,OAAO,CAACD,GAAR,GAAc,UAAUE,OAAV,EAAmB;AAC1CN,EAAAA,MAAM,CAACO,IAAP,CAAY,IAAZ;AAEAD,EAAAA,OAAO,GAAGA,OAAO,IAAI,EAArB,CAH0C,CAGjB;AAEzB;;AACA,OAAKE,KAAL,GAAaF,OAAO,CAACE,KAAR,GAAgB,CAA7B;AACA,OAAKC,MAAL,GAAcH,OAAO,CAACG,MAAR,GAAiB,CAA/B;AAEA,OAAKC,IAAL,GACE,KAAKF,KAAL,GAAa,CAAb,IAAkB,KAAKC,MAAL,GAAc,CAAhC,GACIE,MAAM,CAACC,KAAP,CAAa,IAAI,KAAKJ,KAAT,GAAiB,KAAKC,MAAnC,CADJ,GAEI,IAHN;;AAKA,MAAIH,OAAO,CAACO,IAAR,IAAgB,KAAKH,IAAzB,EAA+B;AAC7B,SAAKA,IAAL,CAAUG,IAAV,CAAe,CAAf;AACD;;AAED,OAAKC,KAAL,GAAa,CAAb;AACA,OAAKC,QAAL,GAAgB,KAAKC,QAAL,GAAgB,IAAhC;AAEA,OAAKC,OAAL,GAAe,IAAIhB,MAAJ,CAAWK,OAAX,CAAf;;AAEA,OAAKW,OAAL,CAAaC,EAAb,CAAgB,OAAhB,EAAyB,KAAKC,IAAL,CAAUC,IAAV,CAAe,IAAf,EAAqB,OAArB,CAAzB;;AACA,OAAKH,OAAL,CAAaC,EAAb,CAAgB,OAAhB,EAAyB,KAAKG,YAAL,CAAkBD,IAAlB,CAAuB,IAAvB,CAAzB;;AACA,OAAKH,OAAL,CAAaC,EAAb,CAAgB,UAAhB,EAA4B,KAAKI,SAAL,CAAeF,IAAf,CAAoB,IAApB,CAA5B;;AACA,OAAKH,OAAL,CAAaC,EAAb,CAAgB,OAAhB,EAAyB,KAAKK,MAAL,CAAYH,IAAZ,CAAiB,IAAjB,CAAzB;;AACA,OAAKH,OAAL,CAAaC,EAAb,CACE,QADF,EAEE,UAAUR,IAAV,EAAgB;AACd,SAAKA,IAAL,GAAYA,IAAZ;AACA,SAAKS,IAAL,CAAU,QAAV,EAAoBT,IAApB;AACD,GAHD,CAGEU,IAHF,CAGO,IAHP,CAFF;;AAQA,OAAKI,OAAL,GAAe,IAAItB,MAAJ,CAAWI,OAAX,CAAf;;AACA,OAAKkB,OAAL,CAAaN,EAAb,CAAgB,MAAhB,EAAwB,KAAKC,IAAL,CAAUC,IAAV,CAAe,IAAf,EAAqB,MAArB,CAAxB;;AACA,OAAKI,OAAL,CAAaN,EAAb,CAAgB,KAAhB,EAAuB,KAAKC,IAAL,CAAUC,IAAV,CAAe,IAAf,EAAqB,KAArB,CAAvB;;AACA,OAAKH,OAAL,CAAaC,EAAb,CAAgB,OAAhB,EAAyB,KAAKG,YAAL,CAAkBD,IAAlB,CAAuB,IAAvB,CAAzB;;AACA,OAAKI,OAAL,CAAaN,EAAb,CAAgB,OAAhB,EAAyB,KAAKC,IAAL,CAAUC,IAAV,CAAe,IAAf,EAAqB,OAArB,CAAzB;AACD,CAxCD;;AAyCAtB,IAAI,CAAC2B,QAAL,CAAcrB,GAAd,EAAmBJ,MAAnB;AAEAI,GAAG,CAACsB,IAAJ,GAAWvB,OAAX;;AAEAC,GAAG,CAACuB,SAAJ,CAAcC,IAAd,GAAqB,YAAY;AAC/B,MAAI,CAAC,KAAKlB,IAAN,IAAc,CAAC,KAAKA,IAAL,CAAUmB,MAA7B,EAAqC;AACnC,SAAKV,IAAL,CAAU,OAAV,EAAmB,kBAAnB;AACA,WAAO,IAAP;AACD;;AAEDW,EAAAA,OAAO,CAACC,QAAR,CACE,YAAY;AACV,SAAKP,OAAL,CAAaI,IAAb,CAAkB,KAAKlB,IAAvB,EAA6B,KAAKF,KAAlC,EAAyC,KAAKC,MAA9C,EAAsD,KAAKK,KAA3D;AACD,GAFD,CAEEM,IAFF,CAEO,IAFP,CADF;AAMA,SAAO,IAAP;AACD,CAbD;;AAeAhB,GAAG,CAACuB,SAAJ,CAAcK,KAAd,GAAsB,UAAUtB,IAAV,EAAgBuB,QAAhB,EAA0B;AAC9C,MAAIA,QAAJ,EAAc;AACZ,QAAIC,QAAJ,EAAcC,OAAd;;AAEAD,IAAAA,QAAQ,GAAG,UAAUE,UAAV,EAAsB;AAC/B,WAAKC,cAAL,CAAoB,OAApB,EAA6BF,OAA7B;AAEA,WAAKzB,IAAL,GAAY0B,UAAZ;AACAH,MAAAA,QAAQ,CAAC,IAAD,EAAO,IAAP,CAAR;AACD,KALU,CAKTb,IALS,CAKJ,IALI,CAAX;;AAOAe,IAAAA,OAAO,GAAG,UAAUG,GAAV,EAAe;AACvB,WAAKD,cAAL,CAAoB,QAApB,EAA8BH,QAA9B;AAEAD,MAAAA,QAAQ,CAACK,GAAD,EAAM,IAAN,CAAR;AACD,KAJS,CAIRlB,IAJQ,CAIH,IAJG,CAAV;;AAMA,SAAKmB,IAAL,CAAU,QAAV,EAAoBL,QAApB;AACA,SAAKK,IAAL,CAAU,OAAV,EAAmBJ,OAAnB;AACD;;AAED,OAAKK,GAAL,CAAS9B,IAAT;AACA,SAAO,IAAP;AACD,CAvBD;;AAyBAN,GAAG,CAACuB,SAAJ,CAAcc,KAAd,GAAsB,UAAU/B,IAAV,EAAgB;AACpC,OAAKO,OAAL,CAAawB,KAAb,CAAmB/B,IAAnB;;AACA,SAAO,IAAP;AACD,CAHD;;AAKAN,GAAG,CAACuB,SAAJ,CAAca,GAAd,GAAoB,UAAU9B,IAAV,EAAgB;AAClC,OAAKO,OAAL,CAAauB,GAAb,CAAiB9B,IAAjB;AACD,CAFD;;AAIAN,GAAG,CAACuB,SAAJ,CAAcL,SAAd,GAA0B,UAAUoB,QAAV,EAAoB;AAC5C,OAAKlC,KAAL,GAAakC,QAAQ,CAAClC,KAAtB;AACA,OAAKC,MAAL,GAAciC,QAAQ,CAACjC,MAAvB;AAEA,OAAKU,IAAL,CAAU,UAAV,EAAsBuB,QAAtB;AACD,CALD;;AAOAtC,GAAG,CAACuB,SAAJ,CAAcJ,MAAd,GAAuB,UAAUT,KAAV,EAAiB;AACtC,OAAKA,KAAL,GAAaA,KAAb;AACD,CAFD;;AAIAV,GAAG,CAACuB,SAAJ,CAAcN,YAAd,GAA6B,YAAY;AACvC,MAAI,CAAC,KAAKJ,OAAL,CAAaD,QAAd,IAA0B,CAAC,KAAKQ,OAAL,CAAaT,QAA5C,EAAsD;AACpD,SAAKI,IAAL,CAAU,OAAV;AACD;AACF,CAJD;;AAMAf,GAAG,CAACuC,MAAJ,GAAa,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0BC,IAA1B,EAAgCvC,KAAhC,EAAuCC,MAAvC,EAA+CuC,MAA/C,EAAuDC,MAAvD,EAA+D;AAC1E;AACA;;AACA;AACAH,EAAAA,IAAI,IAAI,CAAR;AACAC,EAAAA,IAAI,IAAI,CAAR;AACAvC,EAAAA,KAAK,IAAI,CAAT;AACAC,EAAAA,MAAM,IAAI,CAAV;AACAuC,EAAAA,MAAM,IAAI,CAAV;AACAC,EAAAA,MAAM,IAAI,CAAV;AACA;;AAEA,MACEH,IAAI,GAAGF,GAAG,CAACpC,KAAX,IACAuC,IAAI,GAAGH,GAAG,CAACnC,MADX,IAEAqC,IAAI,GAAGtC,KAAP,GAAeoC,GAAG,CAACpC,KAFnB,IAGAuC,IAAI,GAAGtC,MAAP,GAAgBmC,GAAG,CAACnC,MAJtB,EAKE;AACA,UAAM,IAAIyC,KAAJ,CAAU,8BAAV,CAAN;AACD;;AAED,MACEF,MAAM,GAAGH,GAAG,CAACrC,KAAb,IACAyC,MAAM,GAAGJ,GAAG,CAACpC,MADb,IAEAuC,MAAM,GAAGxC,KAAT,GAAiBqC,GAAG,CAACrC,KAFrB,IAGAyC,MAAM,GAAGxC,MAAT,GAAkBoC,GAAG,CAACpC,MAJxB,EAKE;AACA,UAAM,IAAIyC,KAAJ,CAAU,8BAAV,CAAN;AACD;;AAED,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG1C,MAApB,EAA4B0C,CAAC,EAA7B,EAAiC;AAC/BP,IAAAA,GAAG,CAAClC,IAAJ,CAAS0C,IAAT,CACEP,GAAG,CAACnC,IADN,EAEG,CAACuC,MAAM,GAAGE,CAAV,IAAeN,GAAG,CAACrC,KAAnB,GAA2BwC,MAA5B,IAAuC,CAFzC,EAGG,CAACD,IAAI,GAAGI,CAAR,IAAaP,GAAG,CAACpC,KAAjB,GAAyBsC,IAA1B,IAAmC,CAHrC,EAIG,CAACC,IAAI,GAAGI,CAAR,IAAaP,GAAG,CAACpC,KAAjB,GAAyBsC,IAAzB,GAAgCtC,KAAjC,IAA2C,CAJ7C;AAMD;AACF,CAtCD;;AAwCAJ,GAAG,CAACuB,SAAJ,CAAcgB,MAAd,GAAuB,UACrBE,GADqB,EAErBC,IAFqB,EAGrBC,IAHqB,EAIrBvC,KAJqB,EAKrBC,MALqB,EAMrBuC,MANqB,EAOrBC,MAPqB,EAQrB;AACA;AAEA7C,EAAAA,GAAG,CAACuC,MAAJ,CAAW,IAAX,EAAiBE,GAAjB,EAAsBC,IAAtB,EAA4BC,IAA5B,EAAkCvC,KAAlC,EAAyCC,MAAzC,EAAiDuC,MAAjD,EAAyDC,MAAzD;AACA,SAAO,IAAP;AACD,CAbD;;AAeA7C,GAAG,CAACiD,WAAJ,GAAkB,UAAUT,GAAV,EAAe;AAC/B,MAAIA,GAAG,CAAC9B,KAAR,EAAe;AACb,SAAK,IAAIqC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGP,GAAG,CAACnC,MAAxB,EAAgC0C,CAAC,EAAjC,EAAqC;AACnC,WAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGV,GAAG,CAACpC,KAAxB,EAA+B8C,CAAC,EAAhC,EAAoC;AAClC,YAAIC,GAAG,GAAIX,GAAG,CAACpC,KAAJ,GAAY2C,CAAZ,GAAgBG,CAAjB,IAAuB,CAAjC;;AAEA,aAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;AAC1B,cAAIC,MAAM,GAAGb,GAAG,CAAClC,IAAJ,CAAS6C,GAAG,GAAGC,CAAf,IAAoB,GAAjC;AACAC,UAAAA,MAAM,GAAGC,IAAI,CAACC,GAAL,CAASF,MAAT,EAAiB,IAAI,GAAJ,GAAUb,GAAG,CAAC9B,KAA/B,CAAT;AACA8B,UAAAA,GAAG,CAAClC,IAAJ,CAAS6C,GAAG,GAAGC,CAAf,IAAoBE,IAAI,CAACE,KAAL,CAAWH,MAAM,GAAG,GAApB,CAApB;AACD;AACF;AACF;;AACDb,IAAAA,GAAG,CAAC9B,KAAJ,GAAY,CAAZ;AACD;AACF,CAfD;;AAiBAV,GAAG,CAACuB,SAAJ,CAAc0B,WAAd,GAA4B,YAAY;AACtCjD,EAAAA,GAAG,CAACiD,WAAJ,CAAgB,IAAhB;AACD,CAFD","sourcesContent":["\"use strict\";\n\nlet util = require(\"util\");\nlet Stream = require(\"stream\");\nlet Parser = require(\"./parser-async\");\nlet Packer = require(\"./packer-async\");\nlet PNGSync = require(\"./png-sync\");\n\nlet PNG = (exports.PNG = function (options) {\n  Stream.call(this);\n\n  options = options || {}; // eslint-disable-line no-param-reassign\n\n  // coerce pixel dimensions to integers (also coerces undefined -> 0):\n  this.width = options.width | 0;\n  this.height = options.height | 0;\n\n  this.data =\n    this.width > 0 && this.height > 0\n      ? Buffer.alloc(4 * this.width * this.height)\n      : null;\n\n  if (options.fill && this.data) {\n    this.data.fill(0);\n  }\n\n  this.gamma = 0;\n  this.readable = this.writable = true;\n\n  this._parser = new Parser(options);\n\n  this._parser.on(\"error\", this.emit.bind(this, \"error\"));\n  this._parser.on(\"close\", this._handleClose.bind(this));\n  this._parser.on(\"metadata\", this._metadata.bind(this));\n  this._parser.on(\"gamma\", this._gamma.bind(this));\n  this._parser.on(\n    \"parsed\",\n    function (data) {\n      this.data = data;\n      this.emit(\"parsed\", data);\n    }.bind(this)\n  );\n\n  this._packer = new Packer(options);\n  this._packer.on(\"data\", this.emit.bind(this, \"data\"));\n  this._packer.on(\"end\", this.emit.bind(this, \"end\"));\n  this._parser.on(\"close\", this._handleClose.bind(this));\n  this._packer.on(\"error\", this.emit.bind(this, \"error\"));\n});\nutil.inherits(PNG, Stream);\n\nPNG.sync = PNGSync;\n\nPNG.prototype.pack = function () {\n  if (!this.data || !this.data.length) {\n    this.emit(\"error\", \"No data provided\");\n    return this;\n  }\n\n  process.nextTick(\n    function () {\n      this._packer.pack(this.data, this.width, this.height, this.gamma);\n    }.bind(this)\n  );\n\n  return this;\n};\n\nPNG.prototype.parse = function (data, callback) {\n  if (callback) {\n    let onParsed, onError;\n\n    onParsed = function (parsedData) {\n      this.removeListener(\"error\", onError);\n\n      this.data = parsedData;\n      callback(null, this);\n    }.bind(this);\n\n    onError = function (err) {\n      this.removeListener(\"parsed\", onParsed);\n\n      callback(err, null);\n    }.bind(this);\n\n    this.once(\"parsed\", onParsed);\n    this.once(\"error\", onError);\n  }\n\n  this.end(data);\n  return this;\n};\n\nPNG.prototype.write = function (data) {\n  this._parser.write(data);\n  return true;\n};\n\nPNG.prototype.end = function (data) {\n  this._parser.end(data);\n};\n\nPNG.prototype._metadata = function (metadata) {\n  this.width = metadata.width;\n  this.height = metadata.height;\n\n  this.emit(\"metadata\", metadata);\n};\n\nPNG.prototype._gamma = function (gamma) {\n  this.gamma = gamma;\n};\n\nPNG.prototype._handleClose = function () {\n  if (!this._parser.writable && !this._packer.readable) {\n    this.emit(\"close\");\n  }\n};\n\nPNG.bitblt = function (src, dst, srcX, srcY, width, height, deltaX, deltaY) {\n  // eslint-disable-line max-params\n  // coerce pixel dimensions to integers (also coerces undefined -> 0):\n  /* eslint-disable no-param-reassign */\n  srcX |= 0;\n  srcY |= 0;\n  width |= 0;\n  height |= 0;\n  deltaX |= 0;\n  deltaY |= 0;\n  /* eslint-enable no-param-reassign */\n\n  if (\n    srcX > src.width ||\n    srcY > src.height ||\n    srcX + width > src.width ||\n    srcY + height > src.height\n  ) {\n    throw new Error(\"bitblt reading outside image\");\n  }\n\n  if (\n    deltaX > dst.width ||\n    deltaY > dst.height ||\n    deltaX + width > dst.width ||\n    deltaY + height > dst.height\n  ) {\n    throw new Error(\"bitblt writing outside image\");\n  }\n\n  for (let y = 0; y < height; y++) {\n    src.data.copy(\n      dst.data,\n      ((deltaY + y) * dst.width + deltaX) << 2,\n      ((srcY + y) * src.width + srcX) << 2,\n      ((srcY + y) * src.width + srcX + width) << 2\n    );\n  }\n};\n\nPNG.prototype.bitblt = function (\n  dst,\n  srcX,\n  srcY,\n  width,\n  height,\n  deltaX,\n  deltaY\n) {\n  // eslint-disable-line max-params\n\n  PNG.bitblt(this, dst, srcX, srcY, width, height, deltaX, deltaY);\n  return this;\n};\n\nPNG.adjustGamma = function (src) {\n  if (src.gamma) {\n    for (let y = 0; y < src.height; y++) {\n      for (let x = 0; x < src.width; x++) {\n        let idx = (src.width * y + x) << 2;\n\n        for (let i = 0; i < 3; i++) {\n          let sample = src.data[idx + i] / 255;\n          sample = Math.pow(sample, 1 / 2.2 / src.gamma);\n          src.data[idx + i] = Math.round(sample * 255);\n        }\n      }\n    }\n    src.gamma = 0;\n  }\n};\n\nPNG.prototype.adjustGamma = function () {\n  PNG.adjustGamma(this);\n};\n"]},"metadata":{},"sourceType":"script"}